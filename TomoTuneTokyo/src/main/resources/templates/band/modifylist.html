<!DOCTYPE html>

<html lang="ja" xmlns:th="http://www.thymeleaf.org"
  xmlns:layout="http://www.ultrag.net.nz/thymeleaf/layout"
  layout:decorate="~{layouts/layout}">

<head>
  <title>ãƒãƒ³ãƒ‰ãƒªã‚¹ãƒˆ</title>
  <link rel="stylesheet" href="/css/board-style.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
</head>

<body>
  <div layout:fragment="content" class="board-container">
    <div class="recruit-post-btn-wrap">
		<button type="button" class="recruit-post-btn" id="openApplyModal" data-toggle="modal" data-target="#applyModal">
		  ãƒãƒ³ãƒ‰çµæˆç™»éŒ²
		</button>
    </div>
    <h2 class="board-title">ãƒãƒ³ãƒ‰ãƒªã‚¹ãƒˆ</h2>

	<!-- ğŸ” ê²€ìƒ‰ì°½ -->
	<div class="search-bar">
	  <form method="get" th:action="@{/bandinsert/modifylist}" style="display: contents;">
	    <input type="text" class="search-input" name="keyword" placeholder="ãƒãƒ¼ãƒ åæ¤œç´¢" th:value="${keyword}">
	    <button type="submit" class="search-btn">æ¤œç´¢</button>
	  </form>
	</div>

<!-- í•´ì‹œíƒœê·¸ ì„ íƒ ì˜ì—­ -->
<div class="selected-tags-title"># è‡ªåˆ†ã®å¥½ã¿ã§ã‚ã‚‹ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¤œç´¢</div>
<div class="selected-tags"></div>
<div class="keyword-box">
  <!-- âœ… ã‚¸ãƒ£ãƒ³ãƒ« -->
  <div class="keyword-row">
    <div class="keyword-category">ã‚¸ãƒ£ãƒ³ãƒ«</div>
    <div class="keyword-tags">
      <a href="?genre=ãƒ­ãƒƒã‚¯" class="tag" th:classappend="${param.genre} == 'ãƒ­ãƒƒã‚¯' ? ' active' : ''">ãƒ­ãƒƒã‚¯</a>
      <a href="?genre=ãƒãƒƒãƒ—" class="tag" th:classappend="${param.genre} == 'ãƒãƒƒãƒ—' ? ' active' : ''">ãƒãƒƒãƒ—</a>
      <a href="?genre=ã‚¸ãƒ£ã‚º" class="tag" th:classappend="${param.genre} == 'ã‚¸ãƒ£ã‚º' ? ' active' : ''">ã‚¸ãƒ£ã‚º</a>
      <a href="?genre=ãƒ’ãƒƒãƒ—ãƒ›ãƒƒãƒ—" class="tag" th:classappend="${param.genre} == 'ãƒ’ãƒƒãƒ—ãƒ›ãƒƒãƒ—' ? ' active' : ''">ãƒ’ãƒƒãƒ—ãƒ›ãƒƒãƒ—</a>
      <a href="?genre=ã‚¯ãƒ©ã‚·ãƒƒã‚¯" class="tag" th:classappend="${param.genre} == 'ã‚¯ãƒ©ã‚·ãƒƒã‚¯' ? ' active' : ''">ã‚¯ãƒ©ã‚·ãƒƒã‚¯</a>
      <a href="?genre=EDM" class="tag" th:classappend="${param.genre} == 'EDM' ? ' active' : ''">EDM</a>
      <a href="?genre=ãã®ä»–" class="tag" th:classappend="${param.genre} == 'ãã®ä»–' ? ' active' : ''">ãã®ä»–</a>
    </div>
  </div>

  <!-- âœ… ãƒã‚¸ã‚·ãƒ§ãƒ³ -->
  <div class="keyword-row">
    <div class="keyword-category">ãƒã‚¸ã‚·ãƒ§ãƒ³</div>
    <div class="keyword-tags">
      <a href="?position=Voï¼ˆãƒœãƒ¼ã‚«ãƒ«ï¼‰" class="tag" th:classappend="${param.position} == 'Voï¼ˆãƒœãƒ¼ã‚«ãƒ«ï¼‰' ? ' active' : ''">Voï¼ˆãƒœãƒ¼ã‚«ãƒ«ï¼‰</a>
      <a href="?position=Gtï¼ˆã‚®ã‚¿ãƒ¼ï¼‰" class="tag" th:classappend="${param.position} == 'Gtï¼ˆã‚®ã‚¿ãƒ¼ï¼‰' ? ' active' : ''">Gtï¼ˆã‚®ã‚¿ãƒ¼ï¼‰</a>
      <a href="?position=Baï¼ˆãƒ™ãƒ¼ã‚¹ï¼‰" class="tag" th:classappend="${param.position} == 'Baï¼ˆãƒ™ãƒ¼ã‚¹ï¼‰' ? ' active' : ''">Baï¼ˆãƒ™ãƒ¼ã‚¹ï¼‰</a>
      <a href="?position=Drï¼ˆãƒ‰ãƒ©ãƒ ï¼‰" class="tag" th:classappend="${param.position} == 'Drï¼ˆãƒ‰ãƒ©ãƒ ï¼‰' ? ' active' : ''">Drï¼ˆãƒ‰ãƒ©ãƒ ï¼‰</a>
      <a href="?position=Kbï¼ˆã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ï¼‰" class="tag" th:classappend="${param.position} == 'Kbï¼ˆã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ï¼‰' ? ' active' : ''">Kbï¼ˆã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ï¼‰</a>
      <a href="?position=ãã®ä»–" class="tag" th:classappend="${param.position} == 'ãã®ä»–' ? ' active' : ''">ãã®ä»–</a>
    </div>
  </div>

  <!-- âœ… æ€§åˆ¥ -->
  <div class="keyword-row">
    <div class="keyword-category">æ€§åˆ¥</div>
    <div class="keyword-tags">
      <a href="?gender=ç”·æ€§ãƒãƒ³ãƒ‰" class="tag" th:classappend="${param.gender} == 'ç”·æ€§ãƒãƒ³ãƒ‰' ? ' active' : ''">ç”·æ€§ãƒãƒ³ãƒ‰</a>
      <a href="?gender=å¥³æ€§ãƒãƒ³ãƒ‰" class="tag" th:classappend="${param.gender} == 'å¥³æ€§ãƒãƒ³ãƒ‰' ? ' active' : ''">å¥³æ€§ãƒãƒ³ãƒ‰</a>
      <a href="?gender=æ··æˆãƒãƒ³ãƒ‰" class="tag" th:classappend="${param.gender} == 'æ··æˆãƒãƒ³ãƒ‰' ? ' active' : ''">æ··æˆãƒãƒ³ãƒ‰</a>
    </div>
  </div>

  <!-- âœ… å¹´é½¢ä»£ -->
  <div class="keyword-row">
    <div class="keyword-category">å¹´é½¢ä»£</div>
    <div class="keyword-tags">
      <a href="?age=10ä»£" class="tag" th:classappend="${param.age} == '10ä»£' ? ' active' : ''">10ä»£</a>
      <a href="?age=20ä»£" class="tag" th:classappend="${param.age} == '20ä»£' ? ' active' : ''">20ä»£</a>
      <a href="?age=30ä»£" class="tag" th:classappend="${param.age} == '30ä»£' ? ' active' : ''">30ä»£</a>
      <a href="?age=40ä»£" class="tag" th:classappend="${param.age} == '40ä»£' ? ' active' : ''">40ä»£</a>
      <a href="?age=50ä»£ä»¥ä¸Š" class="tag" th:classappend="${param.age} == '50ä»£ä»¥ä¸Š' ? ' active' : ''">50ä»£ä»¥ä¸Š</a>
    </div>
  </div>
</div>

<!-- ì¹´ë“œ ëª©ë¡ -->
<!-- ğŸ” ê²€ìƒ‰ì–´ê°€ ìˆì„ ê²½ìš° bandnamelist ì¶œë ¥ -->
<div class="board-card-grid" th:if="${keyword != null and !#strings.isEmpty(keyword)}">
  <div class="board-card" th:each="band : ${bandnamelist}">
	<a th:href="@{'/bandinsertselect/modify?band_id=' + ${band.band_id}}">
      <img th:src="@{${band.band_profile_img != null ? '/images/uploads/bands/' + band.band_profile_img : '/images/default.png'}}"
           alt="ì¸ë„¤ì¼" class="card-image">
    </a>
    <div class="card-info">
      <h3 class="card-title" th:text="${band.band_name}">ãƒãƒ³ãƒ‰å</h3>
      <p class="card-summary" th:text="${band.band_intro}">ãƒãƒ³ãƒ‰ç´¹ä»‹</p>
      <p class="card-meta">
        <span th:text="${band.stage_name}">ì‘ì„±ì</span> |
        <span th:text="${#temporals.format(band.created_at, 'yyyy.MM.dd')}">ë‚ ì§œ</span> |
      </p>
    </div>
  </div>
</div>

<!-- ğŸ” ê²€ìƒ‰ì–´ê°€ ì—†ì„ ê²½ìš° ê¸°ì¡´ bandList ì¶œë ¥ -->
<div class="board-card-grid" th:if="${keyword == null or #strings.isEmpty(keyword)}">
  <div class="board-card" th:each="band : ${bandList}">
	<a th:href="@{'/bandinsertselect/modify?band_id=' + ${band.band_id}}">
      <img th:src="@{${band.band_profile_img != null ? '/images/uploads/bands/' + band.band_profile_img : '/images/default.png'}}"
           alt="ì¸ë„¤ì¼" class="card-image">
    </a>
    <div class="card-info">
      <h3 class="card-title" th:text="${band.band_name}">ãƒãƒ³ãƒ‰å</h3>
      <p class="card-summary" th:text="${band.band_intro}">ãƒãƒ³ãƒ‰ç´¹ä»‹</p>
      <p class="card-meta">
        <span th:text="${band.stage_name}">ì‘ì„±ì</span> |
        <span th:text="${#temporals.format(band.created_at, 'yyyy.MM.dd')}">ë‚ ì§œ</span> |
      </p>
    </div>
  </div>
</div>

  <!-- âœ… ë°´ë“œ ê²°ì„± ë“±ë¡ ëª¨ë‹¬ -->

<div class="modal fade" id="applyModal" tabindex="-1" role="dialog" aria-labelledby="applyModalLabel">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title" id="applyModalLabel">ãƒãƒ³ãƒ‰çµæˆç™»éŒ²ãƒ•ã‚©ãƒ¼ãƒ </h4>
      </div>
      <div class="modal-body">
		<form id="applyForm" method="post" action="/bandinsert/bandsinsert" enctype="multipart/form-data">
			<input type = "hidden" th:name = "${_csrf.parameterName}" th:value = "${_csrf.token}">
			<div id="page1">
			  <div class="form-group">
			    <label for="bandName">ãƒãƒ³ãƒ‰å</label>
			    <input type="text" class="form-control" id="bandName" name="band_name" placeholder="ä¾‹: Tomato Groove">
			  </div>

	  <div class="form-group">
	    <label for="formationDate">çµæˆæ—¥</label>
		<input type="date" class="form-control" id="formationDate" name="formation_date" placeholder="å¹´-æœˆ-æ—¥">
	  </div>

	  <div class="form-group">
	    <label for="bandIntro">ç´¹ä»‹æ–‡</label>
	    <textarea class="form-control" id="bandIntro" name="band_intro" rows="3" placeholder="ãƒãƒ³ãƒ‰ç´¹ä»‹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"></textarea>
	  </div>

	  <div class="form-group">
	    <label>ã‚¸ãƒ£ãƒ³ãƒ«ãƒ»ãƒã‚¸ã‚·ãƒ§ãƒ³ãƒ»æ€§åˆ¥ãƒ»å¹´é½¢ä»£</label>
	    <div class="keyword-box">
	      <div class="keyword-row">
	        <div class="keyword-category">ã‚¸ãƒ£ãƒ³ãƒ«</div>
	        <div class="keyword-tags" id="genre-tags">
	          <span class="tag">ãƒ­ãƒƒã‚¯</span>
	          <span class="tag">ãƒãƒƒãƒ—</span>
	          <span class="tag">ã‚¸ãƒ£ã‚º</span>
	          <span class="tag">ãƒ’ãƒƒãƒ—ãƒ›ãƒƒãƒ—</span>
	          <span class="tag">ã‚¯ãƒ©ã‚·ãƒƒã‚¯</span>
	          <span class="tag">EDM</span>
	          <span class="tag">ãã®ä»–</span>
	        </div>
	      </div>
	      <div class="keyword-row">
	        <div class="keyword-category">ãƒã‚¸ã‚·ãƒ§ãƒ³</div>
	        <div class="keyword-tags" id="position-tags">
	          <span class="tag">Voï¼ˆãƒœãƒ¼ã‚«ãƒ«ï¼‰</span>
	          <span class="tag">Gtï¼ˆã‚®ã‚¿ãƒ¼ï¼‰</span>
	          <span class="tag">Baï¼ˆãƒ™ãƒ¼ã‚¹ï¼‰</span>
	          <span class="tag">Drï¼ˆãƒ‰ãƒ©ãƒ ï¼‰</span>
	          <span class="tag">Kbï¼ˆã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ï¼‰</span>
	          <span class="tag">ãã®ä»–</span>
	        </div>
	      </div>
	      <div class="keyword-row">
	        <div class="keyword-category">æ€§åˆ¥</div>
	        <div class="keyword-tags" id="gender-tags">
	          <span class="tag">ç”·æ€§ãƒãƒ³ãƒ‰</span>
	          <span class="tag">å¥³æ€§ãƒãƒ³ãƒ‰</span>
	          <span class="tag">æ··æˆãƒãƒ³ãƒ‰</span>
	        </div>
	      </div>
	      <div class="keyword-row">
	        <div class="keyword-category">å¹´é½¢ä»£</div>
	        <div class="keyword-tags" id="age-tags">
	          <span class="tag">10ä»£</span>
	          <span class="tag">20ä»£</span>
	          <span class="tag">30ä»£</span>
	          <span class="tag">40ä»£</span>
	          <span class="tag">50ä»£ä»¥ä¸Š</span>
	        </div>
	      </div>
	    </div>
	  </div>

	  <div class="form-group">
	    <label for="region">æ´»å‹•åœ°åŸŸ</label>
	    <input type="text" class="form-control" id="region" name="region" placeholder="ä¾‹: ã‚½ã‚¦ãƒ«å¼˜å¤§ã€æ±äº¬æ¸‹è°·">
	  </div>

	  <div class="form-group">
	  	    <label for="leaderComment">ãƒªãƒ¼ãƒ€ãƒ¼ã®ã‚³ãƒ¡ãƒ³ãƒˆ</label>
	  	    <textarea class="form-control" id="leaderComment" name="leader_comment" rows="2" placeholder="ãƒªãƒ¼ãƒ€ãƒ¼ã‹ã‚‰ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸"></textarea>
	  	  </div>

	  <input type="hidden" name="selectedGenres" id="selectedGenres">
	  <input type="hidden" name="selectedPositions" id="selectedPositions">
	  <input type="hidden" name="selectedGenders" id="selectedGenders">
	  <input type="hidden" name="selectedAges" id="selectedAges">

	  <div class="text-center">
	    <button type="button" class="btn btn-primary" id="nextPage">æ¬¡ã¸</button>
	  </div>
	</div>

	<!-- 2í˜ì´ì§€ -->
	<div id="page2" style="display:none;">
	  <div class="form-group">
	    <label for="bandProfileImage">ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒ</label>
	    <input type="file" class="form-control" id="bandProfileImage" name="bandProfileImage" accept="image/*">
	  </div>

	  <div class="form-group">
	    <label for="bandCoverImage">ãƒãƒ³ãƒ‰ã‚«ãƒãƒ¼ç”»åƒ</label>
		<input type="file" class="form-control" id="bandCoverImage" name="bandCoverImage" accept="image/*">
	  </div>

	  <div class="form-group">
	    <label for="youtubeLink">YouTubeãƒªãƒ³ã‚¯</label>
	    <input type="url" class="form-control" id="youtubeLink" name="youtube_link" placeholder="https://www.youtube.com/@channel">
	  </div>

	  <div class="form-group">
	    <label for="instagramLink">Instagramãƒªãƒ³ã‚¯</label>
	    <input type="url" class="form-control" id="instagramLink" name="instagram_link" placeholder="https://www.instagram.com/yourband">
	  </div>

	  <div class="member-input-group leader-member">
	    <label>ãƒªãƒ¼ãƒ€ãƒ¼</label>
	
		

		<!-- ë¦¬ë” ì´ë¯¸ì§€: ê°’ì´ ì—†ê±°ë‚˜ leaderInfo ìì²´ê°€ nullì¼ ê²½ìš° ê¸°ë³¸ ì´ë¯¸ì§€ í‘œì‹œ -->
		 <img th:src="@{${leaderInfo != null and leaderInfo.user_img != null and !#strings.isEmpty(leaderInfo.user_img) 
					        ? '/images' + leaderInfo.user_img 
					        : '/images/defaultIcon.png'}}" 
					        alt="ë¦¬ë”" class="member-img"
					        style="width:60px; height:60px; border-radius:50%; object-fit:cover;">


			 <!-- leaderInfoê°€ ì¡´ì¬í•  ë•Œ -->
			 <input type="text" th:if="${leaderInfo != null}" th:value="${leaderInfo.nickname}" readonly>

			 <!-- leaderInfoê°€ nullì¼ ë•Œ (ë¹ˆ í•„ë“œ) -->
			 <input type="text" th:if="${leaderInfo == null}" value="" readonly>
			 <input type="text" name="stage_name[]" class="form-control" placeholder="æ´»å‹•å" required>
			     <input type="text" name="member_position[]" class="form-control mb-2" placeholder="ãƒã‚¸ã‚·ãƒ§ãƒ³: ãƒªãƒ¼ãƒ€ãƒ¼, ãƒ—ãƒ­ãƒ‡ãƒ¥ãƒ¼ã‚µãƒ¼">
				 <input type="text" name="member_mbti[]" maxlength="4" pattern="[A-Za-z]{4}" placeholder="ä¾‹: INFP" required>
			     <input type="text" name="favorite_band[]" class="form-control mb-2" placeholder="å¥½ããªãƒãƒ³ãƒ‰: DAY6">
			     <input type="text" name="member_motto[]" class="form-control" placeholder="ä¸€è¨€: éŸ³æ¥½ã¯çœŸå®Ÿã§ã™">
	  </div>

	  <div class="text-center">
	    <button type="button" class="btn btn-primary" id="prevPage">ä»¥å‰ã¸</button>
	    <button type="button" class="btn btn-primary" id="toPage3">æ¬¡ã¸</button>
	  </div>
	</div>
	<!-- 3í˜ì´ì§€ -->
	<div id="page3" style="display:none;">
	  <div id="general-members">
	  
	    <!-- ğŸ”§ ãƒ¡ãƒ³ãƒãƒ¼1 -->
	    <div class="member-input-group general-member">
	      <label>ãƒ¡ãƒ³ãƒãƒ¼1</label>
	      <button type="button" class="btn btn-sm btn-outline-primary mb-2 search-member-btn"
	              data-toggle="modal" data-target="#memberSearchPopup" data-role="general" data-index="0"
	              style="margin-bottom: 10px; font-size: 15px;">ğŸ” ãƒ¡ãƒ³ãƒãƒ¼æ¤œç´¢</button>
	      <div class="selected-member-info mb-2" data-index="0"></div>

	      <!-- âœ… user_id UUIDìš© hidden input -->
	      <input type="hidden" name="user_id_list[]" class="user-id-hidden">

		  <input type="text" class="form-control mb-2 nickname-display" placeholder="ä¾‹: ãƒ¡ãƒ³ãƒãƒ¼å" readonly>
		  <input type="text" name="stage_name[]" class="form-control mb-2" placeholder="æ´»å‹•å" required>
	      <input type="text" name="member_position[]" class="form-control mb-2" placeholder="ãƒã‚¸ã‚·ãƒ§ãƒ³: ãƒœãƒ¼ã‚«ãƒ«">
	      <input type="text" name="member_mbti[]" maxlength="4" pattern="[A-Za-z]{4}" class="form-control mb-2" placeholder="ä¾‹: INFP" required>
	      <input type="text" name="favorite_band[]" class="form-control mb-2" placeholder="å¥½ããªãƒãƒ³ãƒ‰: Aimer">
	      <input type="text" name="member_motto[]" class="form-control" placeholder="ä¸€è¨€: æ­Œã§ä¼ãˆãŸã„">
	    </div>

	    <!-- ğŸ”§ ãƒ¡ãƒ³ãƒãƒ¼2 -->
	    <div class="member-input-group general-member">
	      <label>ãƒ¡ãƒ³ãƒãƒ¼2</label>
	      <button type="button" class="btn btn-sm btn-outline-primary mb-2 search-member-btn"
	              data-toggle="modal" data-target="#memberSearchPopup" data-role="general" data-index="1"
	              style="margin-bottom: 10px; font-size: 15px;">ğŸ” ãƒ¡ãƒ³ãƒãƒ¼æ¤œç´¢</button>
	      <div class="selected-member-info mb-2" data-index="1"></div>

	      <!-- âœ… user_id UUIDìš© hidden input -->
	      <input type="hidden" name="user_id_list[]" class="user-id-hidden">

		  <input type="text" class="form-control mb-2 nickname-display" placeholder="ä¾‹: ãƒ¡ãƒ³ãƒãƒ¼å" readonly>
		  <input type="text" name="stage_name[]" class="form-control mb-2" placeholder="æ´»å‹•å" required>
	      <input type="text" name="member_position[]" class="form-control mb-2" placeholder="ãƒã‚¸ã‚·ãƒ§ãƒ³: ã‚®ã‚¿ãƒ¼">
	      <input type="text" name="member_mbti[]" maxlength="4" pattern="[A-Za-z]{4}" class="form-control mb-2" placeholder="ä¾‹: INFP" required>
	      <input type="text" name="favorite_band[]" class="form-control mb-2" placeholder="å¥½ããªãƒãƒ³ãƒ‰: YOASOBI">
	      <input type="text" name="member_motto[]" class="form-control" placeholder="ä¸€è¨€: éŸ³æ¥½æœ€é«˜!">
	    </div>
	    
	  </div>

	  <!-- ì¶”ê°€ ë²„íŠ¼ ë° ì œì¶œ -->
	  <div>
	    <button type="button" id="addGeneralMemberBtn" class="btn btn-secondary mt-3">ï¼‹ ãƒ¡ãƒ³ãƒãƒ¼è¿½åŠ </button>
	    <small class="text-muted d-block mt-2">â€» ãƒ¡ãƒ³ãƒãƒ¼ã¯ä½•äººã§ã‚‚è¿½åŠ ã§ãã¾ã™ã€‚</small>
	  </div>

	  <div class="text-center mt-4" style="padding-top: 80px;">
	    <button type="button" class="btn btn-primary" id="toPage2">ä»¥å‰ã¸</button>
	    <button type="submit" class="btn btn-primary" id="submitApply">ç™»éŒ²ã™ã‚‹</button>
	  </div>
	</div>
</form>

  </div>
</div>
  </div>
</div>

    <!-- í˜ì´ì§• -->
	<div class="board-pagination" th:if="${totalPages != null and totalPages > 1}">
	  <!-- ì´ì „ í˜ì´ì§€ -->
	  <button class="page-btn"
	          th:if="${page > 1}"
	          th:onclick="'location.href=\'' + @{/bandinsert/modifylist(page=${page - 1}, genre=${selectedGenre}, position=${selectedPosition}, gender=${selectedGender}, age=${selectedAge})} + '\''">
	    &laquo;
	  </button>

	  <!-- í˜ì´ì§€ ìˆ«ì -->
	  <button class="page-btn"
	          th:each="i : ${#numbers.sequence(1, totalPages)}"
	          th:classappend="${i} == ${page} ? ' active' : ''"
	          th:onclick="'location.href=\'' + @{/bandinsert/modifylist(page=${i}, genre=${selectedGenre}, position=${selectedPosition}, gender=${selectedGender}, age=${selectedAge})} + '\''"
	          th:text="${i}">
	  </button>

	  <!-- ë‹¤ìŒ í˜ì´ì§€ -->
	  <button class="page-btn"
	          th:if="${page < totalPages}"
	          th:onclick="'location.href=\'' + @{/bandinsert/modifylist(page=${page + 1}, genre=${selectedGenre}, position=${selectedPosition}, gender=${selectedGender}, age=${selectedAge})} + '\''">
	    &raquo;
	  </button>
	</div>

<!-- ğŸ” ë©¤ë²„ ê²€ìƒ‰ íŒì—… -->
<div id="memberSearchPopup" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="memberSearchLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content" style="padding: 30px;">
      <div class="modal-header">
        <h4 class="modal-title" id="memberSearchLabel">ãƒ¡ãƒ³ãƒãƒ¼æ¤œç´¢</h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="position: absolute; top: 10px; right: 16px; font-size: 24px;">&times;</button>
      </div>
      <div class="modal-body">
        <input type="text" id="memberSearchInput" class="form-control mb-3" placeholder="åå‰ã§æ¤œç´¢">
        <ul id="memberSearchResult" class="list-group">
        </ul>
      </div>
    </div>
  </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function () {
  // âœ… íƒ­ ì „í™˜ (ì„ íƒì‚¬í•­)
  $('.list-sort-tabs .list').click(function () {
    $('.list-sort-tabs .list').removeClass('active');
    $(this).addClass('active');
  });

  // âœ… ëª¨ë‹¬ ì—´ê¸° ë²„íŠ¼
  $('#openApplyModal').on('click', function () {
    $('#applyModal').modal('show');
  });

  // âœ… í˜ì´ì§€ ì „í™˜
  const page1 = document.getElementById("page1");
  const page2 = document.getElementById("page2");
  const page3 = document.getElementById("page3");

  const nextPageBtn = document.getElementById("nextPage");
  const prevPageBtn = document.getElementById("prevPage");
  const toPage3Btn = document.getElementById("toPage3");
  const toPage2Btn = document.getElementById("toPage2");

  if (nextPageBtn) {
    nextPageBtn.addEventListener("click", function () {
      page1.style.display = "none";
      page2.style.display = "block";
      page3.style.display = "none";
    });
  }

  if (prevPageBtn) {
    prevPageBtn.addEventListener("click", function () {
      page1.style.display = "block";
      page2.style.display = "none";
      page3.style.display = "none";
    });
  }

  if (toPage3Btn) {
    toPage3Btn.addEventListener("click", function () {
      page1.style.display = "none";
      page2.style.display = "none";
      page3.style.display = "block";
    });
  }

  if (toPage2Btn) {
    toPage2Btn.addEventListener("click", function () {
      page1.style.display = "none";
      page2.style.display = "block";
      page3.style.display = "none";
    });
  }

  // âœ… ì¼ë°˜ ë©¤ë²„ ì¶”ê°€
  const addBtn = document.getElementById("addGeneralMemberBtn");
  const container = document.getElementById("general-members");
  let memberCount = 3;

  if (addBtn && container) {
    addBtn.addEventListener("click", function () {
      const group = document.createElement("div");
      group.classList.add("member-input-group", "general-member", "mt-3");

      group.innerHTML = `
        <label>ãƒ¡ãƒ³ãƒãƒ¼${memberCount}</label>
        <button type="button" class="btn btn-sm btn-outline-primary mb-2 search-member-btn"
          data-toggle="modal" data-target="#memberSearchPopup" data-role="general" data-index="${memberCount - 1}">
          ğŸ” ãƒ¡ãƒ³ãƒãƒ¼æ¤œç´¢
        </button>
        <div class="selected-member-info mb-2" data-index="${memberCount - 1}"></div>
		
        <input type="hidden" name="user_id_list[]" class="user-id-hidden">
		<input type="text" name="stage_name[]" class="form-control mb-2" placeholder="ä¾‹: æ´»å‹•å" required>
        <input type="text" name="member_position[]" class="form-control mb-2" placeholder="ãƒã‚¸ã‚·ãƒ§ãƒ³: ãƒœãƒ¼ã‚«ãƒ«">
        <input type="text" name="member_mbti[]" maxlength="4" class="form-control mb-2" placeholder="MBTI: ENFP">
        <input type="text" name="favorite_band[]" class="form-control mb-2" placeholder="å¥½ããªãƒãƒ³ãƒ‰: Aimer">
        <input type="text" name="member_motto[]" class="form-control" placeholder="ä¸€è¨€: æ­Œã§ä¼ãˆãŸã„">
      `;
      container.appendChild(group);
      memberCount++;
    });
  }

  // âœ… íƒœê·¸ ìƒ‰ìƒ í† ê¸€ë§Œ ìˆ˜í–‰ (ì¶œë ¥ ì œê±°)
  document.querySelectorAll(".tag").forEach(tag => {
    tag.addEventListener("click", function () {
      tag.classList.toggle("active");
    });
  });

  // âœ… í¼ ì œì¶œ ì‹œ ëª¨ë‹¬ ë‹«ê¸°
  const form = document.getElementById("applyForm");
  if (form) {
    form.addEventListener("submit", function (e) {
      const getSelectedValues = (selector) => {
        return Array.from(document.querySelectorAll(`${selector} .tag.active`))
          .map(tag => tag.textContent.trim())
          .join(',');
      };

      document.getElementById("selectedGenres").value = getSelectedValues("#genre-tags");
      document.getElementById("selectedPositions").value = getSelectedValues("#position-tags");
      document.getElementById("selectedGenders").value = getSelectedValues("#gender-tags");
      document.getElementById("selectedAges").value = getSelectedValues("#age-tags");

	  alert("ãƒãƒ³ãƒ‰ãŒæ­£å¸¸ã«ç™»éŒ²ã•ã‚Œã¾ã—ãŸï¼");
    });
  }
});
</script>

<script>
	let generalTargetRole = null;
	let generalTargetIndex = null;

	// ğŸ” ì¼ë°˜ ë©¤ë²„ ê²€ìƒ‰ ë²„íŠ¼ í´ë¦­ ì‹œ
	$(document).on('click', '.search-member-btn', function () {
		generalTargetRole = $(this).data('role'); // ì¼ë°˜ ë©¤ë²„ëŠ” í•­ìƒ 'general'
		generalTargetIndex = $(this).data('index') ?? null;

		$('#memberSearchInput').val('');
		$('#memberSearchResult').empty();
		$('#memberSearchInput').trigger('input'); // íŒì—… ì—´ìë§ˆì ì „ì²´ ì¡°íšŒ
		$('#memberSearchPopup').modal('show');
	});

	// ğŸ” ê²€ìƒ‰ì–´ ì…ë ¥ ì‹œ (ë˜ëŠ” ìë™ í˜¸ì¶œ ì‹œ)
	$('#memberSearchInput').on('input', function () {
		const keyword = $(this).val().trim();

		// ì¼ë°˜ ë©¤ë²„ ê²€ìƒ‰: keyword ìˆìœ¼ë©´ í•„í„°, ì—†ìœ¼ë©´ ì „ì²´ ì¡°íšŒ
		const url = (generalTargetRole === 'general')
			? (keyword
				? `/bandinsert/membersearch/general?keyword=${encodeURIComponent(keyword)}`
				: '/bandinsert/membersearch/allmember')
			: null;

		if (!url) return;

		$.get(url, function (data) {
			const resultArea = $('#memberSearchResult').empty();

			if (!data || data.length === 0) {
				resultArea.append('<li class="list-group-item">æ¤œç´¢çµæœãŒã‚ã‚Šã¾ã›ã‚“</li>');
				return;
			}

			const members = Array.isArray(data) ? data : [data];

			members.forEach(user => {
				const userImg = user.user_img && user.user_img.trim() !== ''
					? `/images${user.user_img}`
					: '/images/defaultIcon.png';

					const li = $(`
					  <li class="list-group-item member-result-item" style="cursor:pointer"
					      data-nickname="${user.nickname}"
					      data-user-id="${user.user_id}"
					      data-stage-name=""
					      data-image="${userImg}">
					    <img src="${userImg}" style="width:30px; height:30px; border-radius:50%; margin-right:8px;">
					    ${user.nickname}
					  </li>
					`);

				resultArea.append(li);
			});
		});
	});

	// âœ… ì¼ë°˜ ë©¤ë²„ í´ë¦­ ì‹œ ë°ì´í„° ë°˜ì˜
	$(document).on('click', '.member-result-item', function () {
		const name = $(this).data('nickname');
		const image = $(this).data('image');
		const userId = $(this).data('user-id');

		if (generalTargetRole === 'general' && generalTargetIndex !== null) {
			const $target = $(`.general-member`).filter(function () {
				return $(this).find('.selected-member-info').data('index') === generalTargetIndex;
			});

			if ($target.length > 0) {
				$target.find('.selected-member-info').html(`<img src="${image}" class="img-circle" style="width:100px;">`);
				$target.find('.nickname-display').val(name);
				$target.find('input[name="user_id_list[]"]').val(userId);
			} else {
				console.warn('âŒ í•´ë‹¹ indexì˜ ë©¤ë²„ ë¸”ë¡ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
			}
		}

		$('#memberSearchPopup').modal('hide');
	});

</script>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    // âœ… ê²€ìƒ‰ íŒŒë¼ë¯¸í„° ì œê±°
    const url = new URL(window.location.href);
    if (url.searchParams.has("keyword")) {
      url.searchParams.delete("keyword");
      window.history.replaceState({}, document.title, url.pathname + url.search);
    }
  });
</script>

<script>
document.addEventListener("DOMContentLoaded", function () {
  const tags = document.querySelectorAll('a.tag');

  tags.forEach(tag => {
    const param = tag.getAttribute('href').split('=')[0].replace('?', '');
    const value = tag.getAttribute('href').split('=')[1];

    tag.addEventListener('click', function (e) {
      e.preventDefault(); // ê¸°ë³¸ ë§í¬ ì´ë™ ë§‰ê¸°

      const url = new URL(window.location.href);
      const current = url.searchParams.get(param);

      if (current === value) {
        url.searchParams.delete(param); // í˜„ì¬ ì„ íƒëœ ê°’ â†’ ì œê±° (í•´ì œ)
      } else {
        url.searchParams.set(param, value); // ìƒˆë¡œìš´ ê°’ â†’ ì„¤ì •
      }

      window.location.href = url.toString(); // ìƒˆ URLë¡œ ì´ë™
    });
  });
});
</script>
<script>
document.addEventListener("DOMContentLoaded", function () {
  const url = new URL(window.location.href);
  const params = url.searchParams;

  document.querySelectorAll('.tag').forEach(tag => {
    const href = tag.getAttribute('href');
    if (!href) return;

    const match = href.match(/[?&]([^=]+)=([^&]+)/);
    if (!match) return;

    const key = match[1];
    const value = match[2];

    // í˜„ì¬ URL íŒŒë¼ë¯¸í„°ì™€ ì¼ì¹˜í•˜ë©´ active í´ë˜ìŠ¤ ì¶”ê°€
    if (params.get(key) === value) {
      tag.classList.add('active');
    }

    // í´ë¦­ ì‹œ ë¦¬ë¡œë“œ ì—†ì´ ì„ íƒ/í•´ì œ
    tag.addEventListener('click', function (e) {
      e.preventDefault();
      const current = params.get(key);

      if (current === value) {
        params.delete(key);
      } else {
        params.set(key, value);
      }

      window.location.href = url.pathname + '?' + params.toString();
    });
  });
});
</script>

<script>
  $('#memberSearchPopup').on('show.bs.modal', function () {
    const $modalDialog = $(this).find('.modal-dialog');

    $modalDialog.css({
      'margin-top': '15vh',
      'margin-bottom': 'auto'
    });

    $(this).find('.modal-body').scrollTop(0);
  });
</script>





</div>
</body>
</html>