<html lang="ja">
<head>
<meta charset="UTF-8" />

<title>MYPAGE Resume Insert Form</title>

<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
	rel="stylesheet">
<link th:href="@{/css/mypage.css}" rel="stylesheet">

<!-- 생년월일 일본 캘린더 -->
<link rel="stylesheet"
	href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" />
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/ja.js"></script>

<!-- 활동기간 일본 캘린더 -->
<script
	src="https://cdn.jsdelivr.net/npm/flatpickr/dist/plugins/monthSelect/index.js"></script>
<link rel="stylesheet"
	href="https://cdn.jsdelivr.net/npm/flatpickr/dist/plugins/monthSelect/style.css">

</head>

<body>
	<!-- 헤더 -->
	<!-- 로고 클릭시 메인 화면으로 이동 -->
	<div class="header">
		<h2 class="logo-title">Tomo Tune Tokyo</h2>
		<!-- 사이드바 아이콘 -->
		<div class="hamburger" onclick="toggleSidebar()">

			<div></div>
			<div></div>
			<div></div>

		</div>
	</div>
	<!-- 사이드바 -->
	<div class="sidebar" id="sidebar">
		<!-- 알림 아이콘 -->
		<div class="notification" onclick="goToNotification()" title="알림">
			<svg xmlns="http://www.w3.org/2000/svg" width="26" height="26"
				viewBox="0 0 24 24" fill="none" stroke="#ffffff" stroke-width="2"
				stroke-linecap="round" stroke-linejoin="round">
    <path d="M18 8a6 6 0 0 0-12 0c0 7-3 9-3 9h18s-3-2-3-9"></path>
    <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
  </svg>
		</div>
		<!-- 사이드바 미니 프로필 -->
		<div class="sidebar-profile">
			<!-- 프로필 이미지 클릭시 프로필 편집화면으로 이동 -->
			<img src="/images/profilecat.jpg" alt="プロフィール画像"
				class="sidebar-avatar">
			<div class="sidebar-nickname">IROYA</div>
			<div class="sidebar-id">@iroiro0107</div>
			<div class="sidebar-email">iroiro@example.com</div>
		</div>
		<!-- 사이드바 메뉴 -->
		<nav>
			<a href="/settings#profile">プロフィール編集</a> <a href="/settings#account">アカウント設定</a>
			<a href="/activity">アクティビティ</a> <a href="/logout">ログアウト</a>
		</nav>
	</div>
	<div class="overlay" id="overlay" onclick="toggleSidebar(false)"></div>
	<!-- 이력서 폼 박스 -->
	<div class="page">
		<div class="box content-box">
			<div class="resume-form">
				<form id="resumeForm" action="/resume/insert" method="post">
					<!-- 활동명(필수) -->
					<h4>
						<label class="field-label">アーティスト名<span
							class="required-label">必須</span></label>
					</h4>
					<input type="text" name="stageName" placeholder="例: NANA" />
					<!-- 성별(필수) 체크박스 -->
					<h4>
						<label class="field-label">性別<span class="required-label">必須</span></label>
					</h4>
					<div class="gender-group">
						<label><input type="radio" name="gender" value="woman">
							女性</label> <label><input type="radio" name="gender" value="man">
							男性</label>
					</div>

					<!-- 생년월일 캘린더(선택) -->
					<h4>
						<label class="field-label">生年月日</label>
					</h4>
					<input type="text" id="birth" name="birth"
						placeholder="例: 2001-01-01" />
					<!-- 이메일(필수) -->
					<h4>
						<label class="field-label">Eメール<span
							class="required-label">必須</span></label>
					</h4>
					<input type="email" name="sns" placeholder="例: example@mail.com" />
					<!-- 연락처(선택) -->
					<h4>
						<label class="field-label">連絡先</label>
					</h4>
					<input type="text" name="phoneNumber"
						placeholder="例: 080-1234-5678" />
					<!-- 활동가능지역(도쿄23구 + 기타) 체크박스(복수선택가능) (필수)-->
					<h4>
						<label class="field-label">活動可能地域（最大5個まで）<span
							class="required-label">必須</span></label>
					</h4>
					<select id="region-select">
						<option value="">選択してください</option>
						<option value="千代田区">千代田区</option>
						<option value="中央区">中央区</option>
						<option value="港区">港区</option>
						<option value="新宿区">新宿区</option>
						<option value="文京区">文京区</option>
						<option value="台東区">台東区</option>
						<option value="墨田区">墨田区</option>
						<option value="江東区">江東区</option>
						<option value="品川区">品川区</option>
						<option value="目黒区">目黒区</option>
						<option value="大田区">大田区</option>
						<option value="世田谷区">世田谷区</option>
						<option value="渋谷区">渋谷区</option>
						<option value="中野区">中野区</option>
						<option value="杉並区">杉並区</option>
						<option value="豊島区">豊島区</option>
						<option value="北区">北区</option>
						<option value="荒川区">荒川区</option>
						<option value="板橋区">板橋区</option>
						<option value="練馬区">練馬区</option>
						<option value="足立区">足立区</option>
						<option value="葛飾区">葛飾区</option>
						<option value="江戸川区">江戸川区</option>
						<option value="その他">その他（入力）</option>
					</select>
					<!-- その他 -->
					<input type="text" id="region-other" placeholder="例: 神奈川県"
						style="display: none;" />
					<!-- 지역 추가하기 버튼 -->
					<div class="form-block">
						<button type="button" onclick="addRegion()">+ 地域追加</button>
					</div>
					<!-- 선택된 지역 목록 -->
					<ul id="selected-regions"></ul>
					<!-- 포지션 체크박스 복수선택가능 (필수)-->
					<h4>
						<label class="field-label">ポジション（複数追加可能）<span
							class="required-label">必須</span></label>
					</h4>
					<div class="form-block checkbox-group">
						<label><input type="checkbox" name="instrument" value="Vo">
							Vo（ボーカル）</label><br /> <label><input type="checkbox"
							name="instrument" value="Gt"> Gt（ギター）</label><br /> <label><input
							type="checkbox" name="instrument" value="Ba"> Ba（ベース）</label><br />
						<label><input type="checkbox" name="instrument" value="Dr">
							Dr（ドラム）</label><br /> <label><input type="checkbox"
							name="instrument" value="Kb"> Kb（キーボード）</label><br /> <label><input
							type="checkbox" name="instrument" value="etc" id="position-etc">
							その他</label><br /> <input type="text" id="position-etc-input"
							name="position-etc-input" placeholder="例: DJ"
							style="display: none;" />
						<!-- その他 -->
						<input type="text" id="position-etc-input"
							name="position-etc-input" placeholder="例: DJ"
							style="display: none;" />
					</div>
					<!-- 선호하는 음악장르, 드롭다운 복수선택가능 -->
					<h4>
						<label class="field-label">好きなジャンル（最大5個まで）</label>
					</h4>
					<select id="genre-select">
						<option value="">選択してください</option>
						<option value="ロック">ロック</option>
						<option value="ポップ">ポップ</option>
						<option value="ジャズ">ジャズ</option>
						<option value="ヒップホップ">ヒップホップ</option>
						<option value="クラシック">クラシック</option>
						<option value="EDM">EDM</option>
						<option value="その他">その他</option>
					</select> <input type="text" id="genre-other" placeholder="例: 演歌"
						style="display: none; margin-top: 0.5rem;" />
					<!-- 추가하기 버튼 -->
					<div class="form-block">
						<button type="button" onclick="addGenre()">+ ジャンル追加</button>
					</div>
					<ul id="selected-genres"
						style="margin-top: 1rem; list-style: none; padding-left: 0;"></ul>
					<!-- 엽습가능요일, 체크박스 복수선택 가능 (필수) -->
					<h4>
						<label class="field-label">練習時間（複数追加可能）<span
							class="required-label">必須</span></label>
					</h4>
					<div class="form-block checkbox-group">
						<label><input type="checkbox" name="days[]" value="月">
							月</label><br /> <label><input type="checkbox" name="days[]"
							value="火"> 火</label><br /> <label><input type="checkbox"
							name="days[]" value="水"> 水</label><br /> <label><input
							type="checkbox" name="days[]" value="木"> 木</label><br /> <label><input
							type="checkbox" name="days[]" value="金"> 金</label><br /> <label><input
							type="checkbox" name="days[]" value="土"> 土</label><br /> <label><input
							type="checkbox" name="days[]" value="日"> 日</label><br />
					</div>

					<!-- 연습가능시간대, 드롭다운 복수선택가능 (필수) -->
					<label>時間代</label> <select id="timeSlot">
						<option value="">-- 選択してください --</option>
						<option value="morning">午前（06時〜12時）</option>
						<option value="afternoon">午後（12時〜18時）</option>
						<option value="evening">夜（18時〜22時）</option>
						<option value="other">その他</option>
					</select>
					<!-- その他 -->
					<label>具体的な時間</label> <input type="text" id="customTime"
						placeholder="例）18時〜22時">
					<!-- 밴드활동이력추가, 버튼 클릭시 입력폼이 나오게(선택) -->
					<h4>
						<label class="field-label">バンド活動履歴（複数追加可能）</label>
					</h4>
					<div id="band-history"></div>
					<div class="form-block">
						<button type="button" onclick="addBandHistory()">+ 活動履歴追加</button>
					</div>
					<!-- 자기소개, 텍스트창 (선택) -->
					<h4>
						<label for="selfIntro">自己紹介</label>
					</h4>
					<textarea id="selfIntro" name="selfIntro" rows="5" cols="50"
						placeholder="例：ギター歴3年、ロックバンド経験あり。よろしくお願いします！"
						style="padding: 10px; font-size: 14px; margin-top: 8px; border-radius: 6px; border: 1px solid #ccc; width: 100%; max-width: 600px;"></textarea>
					<!-- 작성취소 / 리셋 / 저장 버튼  -->
					<div class="button-group" style="justify-content: center;">
						<button type="button" onclick="cancelForm()">作成取消</button>
						<button type="button" onclick="openResetModal()">リセット</button>
						<button type="submit">保存する</button>
					</div>
					<!-- 작성취소 버튼 경고창-->
					<div id="cancelModal" class="modal-overlay">
						<div class="modal-content">
							<p>作成をキャンセルしますか？</p>
							<div class="modal-buttons">
								<button onclick="confirmCancel()">はい</button>
								<button onclick="closeModal()">いいえ</button>
							</div>
						</div>
					</div>
					<!-- 리셋버튼 경고창 -->
					<div id="resetModal" class="modal-overlay">
						<div class="modal-content">
							<p>入力された内容をすべて初期化しますか？</p>
							<div class="modal-buttons">
								<button onclick="confirmReset()">はい</button>
								<button onclick="closeResetModal()">いいえ</button>
							</div>
						</div>
					</div>
					<!-- top 버튼 -->
					<button id="topButton" title="top 버튼">
						<span>↑</span>
					</button>
				</form>
				<!-- resume-form -->
			</div>

			<!-- JS -->
			<!-- 작성취소버튼 -->
			<script>
		function cancelForm() {
			  document.getElementById('cancelModal').classList.add('active');
			}

			function closeModal() {
			  document.getElementById('cancelModal').classList.remove('active');
			}


  function confirmCancel() {
    window.location.href = '/mypage'; // 경로 수정하기 !!
  }
</script>
			<!-- 리셋버튼 -->

			<script>
function openResetModal() {
  document.getElementById('resetModal').classList.add('active');
}

function closeResetModal() {
  document.getElementById('resetModal').classList.remove('active');
}

function confirmReset() {
  document.getElementById("resumeForm").reset();

  document.getElementById("selected-regions").innerHTML = '';
  document.getElementById("region-other").style.display = 'none';

  document.getElementById("selected-genres").innerHTML = '';
  document.getElementById("genre-other").style.display = 'none';

  document.getElementById("position-etc-input").style.display = 'none';

  document.getElementById("customTime").value = '';
  document.getElementById("band-history").innerHTML = '';
  bandCount = 0;

  closeResetModal(); 
}
</script>
			<!-- top 버튼 -->
			<script>
  window.addEventListener('scroll', function () {
    const btn = document.getElementById("topButton");
    if (window.scrollY > 300) {
      btn.style.display = "flex";
    } else {
      btn.style.display = "none";
    }
  });

  document.getElementById("topButton").addEventListener("click", function () {
    window.scrollTo({ top: 0, behavior: "smooth" });
  });
</script>

			<!-- 알림 아이콘 -->
			<script>
  function toggleSidebar(forceClose = null) {
    const sidebar = document.getElementById('sidebar');
    const overlay = document.getElementById('overlay');
    const isActive = sidebar.classList.contains('active');

    if (forceClose === true || isActive) {
      sidebar.classList.remove('active');
      overlay.classList.remove('active');
    } else {
      sidebar.classList.add('active');
      overlay.classList.add('active');
    }
  }

  function goToNotification() {
    window.location.href = '/notification.html'; // 경로 수정하기 !!
  }
</script>
			<!-- 사이드바 아이콘 -->
			<script>
    function toggleSidebar(forceClose = null) {
      const sidebar = document.getElementById('sidebar');
      const overlay = document.getElementById('overlay');
      const isActive = sidebar.classList.contains('active');

      if (forceClose === true || isActive) {
        sidebar.classList.remove('active');
        overlay.classList.remove('active');
      } else {
        sidebar.classList.add('active');
        overlay.classList.add('active');
      }
    }
  </script>
			<!-- 생년월일 캘린더 일본어 -->
			<script>
  flatpickr("#birth", {
    locale: "ja",
    dateFormat: "Y-m-d"
  });
</script>
			<!-- 활동가능지역  -->
			<script>
  const regionSelect = document.getElementById('region-select');
  const regionOther = document.getElementById('region-other');
  const selectedList = document.getElementById('selected-regions');
	// その他 선택 시 입력창 표시
  regionSelect.addEventListener('change', () => {
    regionOther.style.display = regionSelect.value === 'その他' ? 'inline-block' : 'none';
  });

  function addRegion() {
	  let value = regionSelect.value;
	  if (!value) return;

	  if (value === 'その他') {
	    value = regionOther.value.trim();
	    if (!value) {
	      alert("地域名を入力してください");
	      return;
	    }
	  }

	  // 최대 5개까지만 추가 허용
	  if (selectedList.children.length >= 5) {
	    alert("地域は最大5件まで選択できます。");
	    return;
	  }

	  // 이미 추가된 지역인지 확인
	  const existing = [...selectedList.children].some(li => li.dataset.value === value);
	  if (existing) {
	    alert("既に追加されています");
	    return;
	  }

	  const li = document.createElement('li');
	  li.textContent = value + ' ';
	  li.dataset.value = value;

	  const hiddenInput = document.createElement('input');
	  hiddenInput.type = 'hidden';
	  hiddenInput.name = 'region[]';
	  hiddenInput.value = value;
	  li.appendChild(hiddenInput);

	  const removeBtn = document.createElement('button');
	  removeBtn.type = 'button';
	  removeBtn.textContent = '✕';
	  removeBtn.style.marginLeft = '0.5rem';
	  removeBtn.onclick = () => li.remove();
	  li.appendChild(removeBtn);

	  selectedList.appendChild(li);
	  regionSelect.value = '';
	  regionOther.value = '';
	  regionOther.style.display = 'none';
	}

</script>
			<!-- 포지션 その他, 선택시 텍스트창 나타나게 
 -->
			<script>
  document.getElementById('position-etc').addEventListener('change', function () {
    const input = document.getElementById('position-etc-input');
    input.style.display = this.checked ? 'block' : 'none';
  });
</script>
			<!-- 밴드활동이력  -->
			<script>
  const genreSelect = document.getElementById('genre-select');
  const genreOther = document.getElementById('genre-other');
  const genreList = document.getElementById('selected-genres');

  genreSelect.addEventListener('change', () => {
    genreOther.style.display = genreSelect.value === 'その他' ? 'inline-block' : 'none';
  });

  function addGenre() {
    let value = genreSelect.value;
    if (!value) return;

    if (genreList.children.length >= 5) {
      alert("最大5ジャンルまで追加できます");
      return;
    }

    if (value === 'その他') {
      value = genreOther.value.trim();
      if (!value) {
        alert("ジャンル名を入力してください");
        return;
      }
    }

    const exists = [...genreList.children].some(li => li.dataset.value === value);
    if (exists) {
      alert("既に追加されています");
      return;
    }

    const li = document.createElement('li');
    li.textContent = value + ' ';
    li.dataset.value = value;

    const hiddenInput = document.createElement('input');
    hiddenInput.type = 'hidden';
    hiddenInput.name = 'genres[]';
    hiddenInput.value = value;
    li.appendChild(hiddenInput);

    const removeBtn = document.createElement('button');
    removeBtn.type = 'button';
    removeBtn.textContent = '✕';
    removeBtn.style.marginLeft = '0.5rem';
    removeBtn.onclick = () => li.remove();
    li.appendChild(removeBtn);

    genreList.appendChild(li);
    genreSelect.value = '';
    genreOther.value = '';
    genreOther.style.display = 'none';
  }
</script>
			<!-- 밴드활동이력 추가하기 -->
			<script>
  let bandCount = 0;

  function addBandHistory() {
    if (bandCount >= 3) {
      alert("最大3件まで追加できます。");
      return;
    }

    bandCount++;
    const container = document.createElement('div');
    container.className = 'band-card';

    container.innerHTML = `
      <label>バンド名</label>
      <input type="text" name="band_name_${bandCount}" placeholder="例: Oasis" />

      <label>ポジション</label>
      <input type="text" name="band_part_${bandCount}" placeholder="例: ボーカル" />

      <label>活動期間</label>
      <div class="band-period">
        <input type="text" id="band-start-${bandCount}" name="band_start_${bandCount}" placeholder="開始年月を選択" />
        <span>から</span>
        <input type="text" id="band-end-${bandCount}" name="band_end_${bandCount}" placeholder="終了年月を選択" />
        <span>まで</span>
      </div>
    `;

    document.getElementById('band-history').appendChild(container);

    flatpickr(`#band-start-${bandCount}`, {
      locale: "ja",
      dateFormat: "Y-m",
      plugins: [new monthSelectPlugin({ shorthand: true, dateFormat: "Y-m", altFormat: "Y年m月" })]
    });

    flatpickr(`#band-end-${bandCount}`, {
      locale: "ja",
      dateFormat: "Y-m",
      plugins: [new monthSelectPlugin({ shorthand: true, dateFormat: "Y-m", altFormat: "Y年m月" })]
    });
  }
</script>
			<!-- box content-box -->
		</div>
		<!-- page-->
	</div>

</body>
</html>